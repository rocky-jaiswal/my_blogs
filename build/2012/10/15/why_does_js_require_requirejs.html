<!DOCTYPE html>
<html>
  <head>
  <title>Rocky Jaiswal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <link href="/stylesheets/bootstrap.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap-responsive.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/github.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/punchable.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/jquery.js" type="text/javascript"></script>
  <script src="/javascripts/bootstrap.js" type="text/javascript"></script>
  <script src="/javascripts/highlight.pack.js" type="text/javascript"></script>
</head>
  <body>
    <div class="banner navbar-fixed-top">
  <div class="container">
    <h1>
      <a class="head" href="/"><img src="/images/rockyj_banner.png"/></a>
    </h1>
  </div>
</div>
    <div id="main" role="main" class="container">
      <div class="row">
        <div class="span9">
          <div id="main" role="main">
            <article>
              <h2 style="padding-bottom: 10px;">
                  <span class="color-orange">Why does JavaScript require Require.js</span> 
                  <span>Oct 15 2012</span>
              </h2>
              <div class="post">
                <p>Around a week back I started learning about Require.js after someone recommened it to me. When I looked at the <a href='http://requirejs.org/'>website</a> I was not very impressed. My initial reaction was &#8221;<strong>what is require.js trying to solve / why should I use it / how will it make my life better?</strong>&#8221;</p>

<p>I simply moved on, but I also realized that as we are writing more and more JavaScript these days, we need to organize it better. In OO languages such as Java and Ruby we organize code by putting it in classes and maybe having a policy of one class per file, then we load the classes in other classes via dependency loading mechanisms built into the language (like import / require).</p>

<p>JavaScript although being OO has no classes, via CoffeeScript we can still create classes in JavaScript by leveraging the prototype mechanism in JavaScript (but that is perhaps another blog topic) but as our JS code gets bigger how do I organize it and manage dependencies. So I started searching the web for ways to do so. My search led me <a href='http://addyosmani.com/largescalejavascript'>here</a>.</p>

<p>To summarize the article, one of the most common ways to orgainize JS code is through object literals -</p>

<pre><code>//apple.js
var apple = {
  type: &quot;macintosh&quot;,
  color: &quot;red&quot;,
  getInfo: function () {
      return this.color + &#39; &#39; + this.type + &#39; apple&#39;;
  }
}
//console.log(apple.color)</code></pre>

<p>Put a literal in a file and load it in your html. This is the stating point for most developers. Another popular mechanism which kind of builds upon this is Modules -</p>

<pre><code>var basketModule = (function() {
  var basket = []; //private
  return { //exposed to public
    addItem: function(values) {
      basket.push(values);
    },
    getItemCount: function() {
      return basket.length;
    },
    getTotal: function(){
      var q = this.getItemCount(),p=0;
      while(q--){
        p+= basket[q].price; 
      }
      return p;
    }
  }
}());</code></pre>

<p>The advantage of the module pattern is that unlike literals you can expose certain things (what is returned) while some things can be private (like the basket array in example above).</p>

<p>Cool so we have some basic ways to organize our JavaScript, however how do we load these JavaScripts and how do we manage the dependencies. Usually we do it this way -</p>

<pre><code>&lt;script src=&quot;Module1.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module2.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module3.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module4.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module5.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module8.js&quot;&gt;&lt;/script&gt; &lt;!-- want to use 6 in 8... --&gt;
&lt;script src=&quot;Module6.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module7.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;Module8.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;app.js&quot;&gt;&lt;/script&gt;</code></pre>

<p>This is horrible, we load the JavaScript files in HTML and manually order them. If tomorrow things change we have to manually change the order or add or remove files. This is definitely not the way to build good software. Rails asset pipelining tries to solve this but there is still no way to manage JS dependencies.</p>

<p><strong>Require.js</strong> addresses this exact problem.</p>

<p><a href='https://github.com/amdjs/amdjs-api/wiki/AMD'>AMD</a> is a specification which JavaScript developers created and proposed so that the JavaScript dependency management and loading problem is addressed across all JS libraries. Require.js is an impelementation of this specification. We create modules like above but we follow certain syntax to load the dependencies -</p>

<pre><code>//my shirt.js now has some dependencies, a cart and inventory
//module in the same directory as shirt.js
define([&quot;./cart&quot;, &quot;./inventory&quot;], function(cart, inventory) {
    //return an object to define the &quot;my/shirt&quot; module.
    return {
      color: &quot;blue&quot;,
      size: &quot;large&quot;,
      addToCart: function() {
        inventory.decrement(this);
        cart.add(this);
      }
    }
  }
);</code></pre>

<p>define() is the main function require.js provides, we use it to define a module, we first pass an array of dependencies for the module then a function to define the module. We also follow the one module per file policy</p>

<p>Another simple example (in CoffeeScript) would be to place the following code in a file common.coffee</p>

<pre><code>define [], -&gt;

  # What is the enter key constant?
  ENTER_KEY: 13</code></pre>

<p>Now whenever you want to use the &#8220;common&#8221; module just include it as a dependency (like cart in example above).</p>

<p>Finally in our HTML we need to just reference one JavaScript file (please see comments in code below) -</p>

<pre><code>&lt;head&gt;
    &lt;title&gt;My Sample Project&lt;/title&gt;
    &lt;!-- data-main attribute tells require.js to load scripts/main.js after require.js loads. --&gt;
    &lt;script data-main=&quot;scripts/main&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;</code></pre>

<p>In your main.js file you can use require() function to load the JavaScripts. Example Backbone setup -</p>

<pre><code>require([
  &#39;views/app&#39;,
  &#39;routers/router&#39;
], function( AppView, Workspace ) {
  // Initialize routing and start Backbone.history()
  new Workspace();
  Backbone.history.start();

  // Initialize the application view
  new AppView();
});</code></pre>

<p>That is it! After this the other modules will load their dependencies on their own (since they are &#8220;defined&#8221; via require.js).</p>

<p>Finally since some libs are not using define() like jQuery / Backbone how do we load them. The answer lies in <a href='http://requirejs.org/docs/api.html#config-shim'>shims</a>.</p>

<p>For a sample project that uses Require.js, Backbone.js, jQuery and CoffeeScript see - <a href='https://github.com/rocky-jaiswal/todo-js'>this</a>.</p>
              </div>
              <hr/>
              <div id="disqus_thread"></div>
                <script type="text/javascript">
                  $(function(){
                    hljs.initHighlightingOnLoad();
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'rockyj'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  });
                </script>
                <noscript>
                  Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
                </noscript>
                <a href="http://disqus.com" class="dsq-brlink">
                  blog comments powered by <span class="logo-disqus">Disqus</span>
                </a>
            </article>
          </div>
        </div>
        <div id="sidebar">
  <div class="span3">
    <h2>
      <img src="/images/Rocky_Jaiswal.jpg" alt="Rocky Jaiswal" width="121" height="115" style="max-width: 100%;"/>
      <br/>
      <a href="/about">About</a>
    </h2>
    <hr/>
    <h2>
      <a href="https://github.com/rocky-jaiswal" target="_blank">Github</a> /
      <a href="https://twitter.com/whatsuprocky" target="_blank">Twitter</a>
    </h2>
    <hr/>
    <h2>
      <a href="/videos">Videos</a>
    </h2>
    <hr/>
    <h2><a id="show-posts" href="#/posts">Posts</a> / <a id="show-tags" href="#/tags">Tags</a></h2>
    <div class="posts">
      <ol>
        
          <li><a href="/2013/05/03/what_motivates_programmers.html">What motivates programmers</a> <span>May  3 2013</span></li>
        
          <li><a href="/2013/05/02/ajaxify_with_backbone.html">Ajaxify a Form with Backbone</a> <span>May  2 2013</span></li>
        
          <li><a href="/2013/04/08/puppet_in_a_rush.html">Puppet in a rush</a> <span>Apr  8 2013</span></li>
        
          <li><a href="/2013/04/01/building_single_page_applications_and_cors.html">Building Single Page Applications and CORS</a> <span>Apr  1 2013</span></li>
        
          <li><a href="/2013/03/22/integrating_node_and_rails_with_redis.html">Integrating Rails and Node.js via Redis</a> <span>Mar 22 2013</span></li>
        
          <li><a href="/2012/12/13/backbone_and_coffeescript.html">Backbone.js and CoffeeScript - A Perfect Match</a> <span>Dec 13 2012</span></li>
        
          <li><a href="/2012/12/02/serving_rails_from_windows.html">Serving Rails from Windows</a> <span>Dec  2 2012</span></li>
        
          <li><a href="/2012/10/15/why_does_js_require_requirejs.html">Why does JavaScript require Require.js</a> <span>Oct 15 2012</span></li>
        
          <li><a href="/2012/09/22/rails_on_only_jvm.html">Rails on only JVM</a> <span>Sep 22 2012</span></li>
        
          <li><a href="/2012/09/15/akka_with_jruby.html">Akka with JRuby</a> <span>Sep 15 2012</span></li>
        
          <li><a href="/2012/09/09/rails_on_ruby_jruby_a_performance_comparison.html">Running Rails on Ruby or JRuby - A Performance Comparison</a> <span>Sep  9 2012</span></li>
        
          <li><a href="/2012/09/01/deploying_java_apps_with_capistrano.html">Deploying Java applications with Capistrano</a> <span>Sep  1 2012</span></li>
        
          <li><a href="/2012/08/26/accessing_server_data_from_a_native_android_app.html">Accessing server data from a native Android app</a> <span>Aug 26 2012</span></li>
        
          <li><a href="/2012/08/18/why_javascript_is_important.html">Why JavaScript is important</a> <span>Aug 18 2012</span></li>
        
          <li><a href="/2012/06/08/non_tangibles_of_agile.html">The non-tangibles of Agile</a> <span>Jun  8 2012</span></li>
        
          <li><a href="/2012/05/28/moved_to_html.html">Blog moved to pure HTML5, CSS3</a> <span>May 28 2012</span></li>
        
          <li><a href="/2012/05/25/intro_to_backbone_jQuery.html">A gentle introduction to Backbone with jQuery</a> <span>May 25 2012</span></li>
        
          <li><a href="/2012/05/21/video_rubyconf_india.html">Video of my talk with @arunagw at RubyConf India 2012</a> <span>May 21 2012</span></li>
        
          <li><a href="/2012/05/08/setting_up_solr.html">Setting up Solr</a> <span>May  8 2012</span></li>
        
          <li><a href="/2012/03/27/old_jboss_video.html">Old JBoss Video</a> <span>Mar 27 2012</span></li>
        
          <li><a href="/2012/03/26/ruby_conf_india_with_arunagw.html">Slides of my talk with @arunagw in Ruby Conf India 2012</a> <span>Mar 26 2012</span></li>
        
          <li><a href="/2012/03/23/embracing_jruby_1.html">Embracing JRuby - Part 1</a> <span>Mar 23 2012</span></li>
        
          <li><a href="/2012/03/05/musings_on_india_and_technology.html">Musings on India and Technology</a> <span>Mar  5 2012</span></li>
        
          <li><a href="/2012/01/31/job_of_a_software_developer.html">The Job of a Software Developer</a> <span>Jan 31 2012</span></li>
        
          <li><a href="/2011/12/27/configuring-nginx-with-jboss-tomcat.html">Configuring nginx with JBoss / Tomcat</a> <span>Dec 27 2011</span></li>
        
          <li><a href="/2011/12/27/a-weekend-with-couchdb-solr-and-torquebox.html">A weekend with CouchDB, Solr and Torquebox</a> <span>Dec 27 2011</span></li>
        
          <li><a href="/2011/12/01/jquery-flavored-coffeescript.html">jQuery flavored CoffeeScript</a> <span>Dec  1 2011</span></li>
        
          <li><a href="/2011/07/26/and-then-there-was-closure.html">And then there was Closure</a> <span>Jul 26 2011</span></li>
        
          <li><a href="/2011/07/04/the-problem-is-choice.html">The problem is choice</a> <span>Jul  4 2011</span></li>
        
          <li><a href="/2011/06/29/using-spring-for-scheduling-tasks.html">Using Spring for Scheduling Tasks</a> <span>Jun 29 2011</span></li>
        
          <li><a href="/2011/06/25/working-with-oracle-on-linux-ubuntu-fedora.html">Installing Oracle on Linux (Ubuntu / Fedora)</a> <span>Jun 25 2011</span></li>
        
          <li><a href="/2011/06/25/excel-manipulation-and-testing-in-java.html">Excel manipulation and testing in Java</a> <span>Jun 25 2011</span></li>
        
          <li><a href="/2011/06/06/putting-couchdb-and-rails-on-the-cloud.html">Putting CouchDB and Rails on the Cloud</a> <span>Jun  6 2011</span></li>
        
          <li><a href="/2011/05/16/integrating-google-re-captcha-with-a-rails-app.html">Integrating Google Re-Captcha with a Rails app</a> <span>May 16 2011</span></li>
        
          <li><a href="/2011/05/03/the-real-purpose-of-a-sprint-goal.html">The real purpose of a Sprint Goal</a> <span>May  3 2011</span></li>
        
          <li><a href="/2011/05/02/views-from-across-the-table.html">Views from across the table</a> <span>May  2 2011</span></li>
        
          <li><a href="/2011/05/02/thoughts-of-the-week-24-30-april.html">Thoughts of the week 24 - 30 April</a> <span>May  2 2011</span></li>
        
          <li><a href="/2011/04/20/be-happy-to-fail.html">Be Happy to Fail</a> <span>Apr 20 2011</span></li>
        
          <li><a href="/2011/04/14/using-rvm-on-ubuntu-to-install-multiple-versions-of-ruby.html">Using RVM on Ubuntu to install (multiple versions of) Ruby</a> <span>Apr 14 2011</span></li>
        
          <li><a href="/2011/04/11/thoughts-of-the-week-4-10-april.html">Thoughts of the week (4 - 10 April)</a> <span>Apr 11 2011</span></li>
        
          <li><a href="/2011/04/08/mapreduce-in-english.html">MapReduce in English</a> <span>Apr  8 2011</span></li>
        
          <li><a href="/2011/04/01/java-and-ruby-integration-via-soap.html">Java and Ruby integration via SOAP</a> <span>Apr  1 2011</span></li>
        
          <li><a href="/2011/04/01/hello-world.html">Integrating JRuby and Java to create a mini rules engine</a> <span>Apr  1 2011</span></li>
        
          <li><a href="/2011/03/31/hello-jquery.html">Hello jQuery!</a> <span>Mar 31 2011</span></li>
        
          <li><a href="/2011/03/31/accessing-jboss-managed-resources-using-mbeans.html">Accessing JBoss managed resources using MBeans</a> <span>Mar 31 2011</span></li>
        
          <li><a href="/2011/03/31/from-zero-to-a-crud-app-without-writing-a-single-line-of-code-using-jruby.html">From Zero to a CRUD App (without writing a single line of code) using JRuby</a> <span>Mar 31 2011</span></li>
        
          <li><a href="/2011/03/31/google-app-engine-maven-jsf2.html">Google App Engine + Maven + JSF2</a> <span>Mar 31 2011</span></li>
        
          <li><a href="/2011/03/31/integrating-spring-3-with-jpa-2.html">Integrating Spring 3 with JPA 2</a> <span>Mar 31 2011</span></li>
        
          <li><a href="/2011/03/11/big-bad-projects.html">Big bad projects</a> <span>Mar 11 2011</span></li>
        
          <li><a href="/2011/03/01/working-with-git.html">Working with Git</a> <span>Mar  1 2011</span></li>
        
      </ol>
    </div>
    <div class="tags">
      <ol>
        
          <li><a href="/tags/backbone.html">Backbone (5)</a></li>
        
          <li><a href="/tags/javascript.html">JavaScript (9)</a></li>
        
          <li><a href="/tags/coffeescript.html">CoffeeScript (5)</a></li>
        
          <li><a href="/tags/jruby.html">JRuby (11)</a></li>
        
          <li><a href="/tags/rails.html">Rails (6)</a></li>
        
          <li><a href="/tags/agile.html">Agile (8)</a></li>
        
          <li><a href="/tags/scrum.html">Scrum (1)</a></li>
        
          <li><a href="/tags/general.html">General (7)</a></li>
        
          <li><a href="/tags/torquebox.html">Torquebox (4)</a></li>
        
          <li><a href="/tags/ruby.html">Ruby (8)</a></li>
        
          <li><a href="/tags/couchdb.html">CouchDB (2)</a></li>
        
          <li><a href="/tags/nosql.html">NoSQL (1)</a></li>
        
          <li><a href="/tags/solr.html">Solr (2)</a></li>
        
          <li><a href="/tags/jboss.html">JBoss (2)</a></li>
        
          <li><a href="/tags/java.html">Java (9)</a></li>
        
          <li><a href="/tags/scala.html">Scala (2)</a></li>
        
          <li><a href="/tags/akka.html">Akka (1)</a></li>
        
          <li><a href="/tags/capistrano.html">Capistrano (1)</a></li>
        
          <li><a href="/tags/node-js.html">Node.js (1)</a></li>
        
          <li><a href="/tags/require-js.html">Require.js (2)</a></li>
        
          <li><a href="/tags/jpa.html">JPA (1)</a></li>
        
          <li><a href="/tags/spring.html">Spring (2)</a></li>
        
          <li><a href="/tags/jboss.html">Jboss (1)</a></li>
        
          <li><a href="/tags/tomcat.html">Tomcat (1)</a></li>
        
          <li><a href="/tags/programming.html">Programming (1)</a></li>
        
          <li><a href="/tags/git.html">Git (1)</a></li>
        
          <li><a href="/tags/linux.html">Linux (1)</a></li>
        
          <li><a href="/tags/jquery.html">jQuery (1)</a></li>
        
          <li><a href="/tags/cloud.html">Cloud (1)</a></li>
        
          <li><a href="/tags/maven.html">Maven (1)</a></li>
        
          <li><a href="/tags/puppet.html">Puppet (1)</a></li>
        
          <li><a href="/tags/devops.html">DevOps (1)</a></li>
        
          <li><a href="/tags/android.html">Android (1)</a></li>
        
          <li><a href="/tags/phonegap.html">Phonegap (1)</a></li>
        
          <li><a href="/tags/play.html">Play (1)</a></li>
        
      </ol>
    </div>
    <hr/>
  </div>
</div>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-10309067-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  
  $(function() {
    $('.tags').hide();
    $("#show-tags").click(function() {
      $('.tags').toggle();
      $('.posts').toggle();
    });
    $("#show-posts").click(function() {
      $('.tags').toggle();
      $('.posts').toggle();
    });
  });
</script>
      </div>
    </div>
  </body>
</html>
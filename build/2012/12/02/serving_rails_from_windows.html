<!DOCTYPE html>
<html>
  <head>
  <title>Rocky Jaiswal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap-responsive.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/github.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/punchable.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/jquery.js" type="text/javascript"></script>
  <script src="/javascripts/bootstrap.js" type="text/javascript"></script>
  <script src="/javascripts/highlight.pack.js" type="text/javascript"></script>
</head>
  <body>
    <div class="banner">
  <div class="container">
    <h1>
      <a class="head" href="/"><img src="/images/rockyj_banner.png"/></a>
    </h1>
  </div>
</div>
    <div id="main" role="main" class="container">
      <div class="row">
        <div class="span9">
          <div id="main" role="main">
            <article>
              <h2 style="padding-bottom: 10px;">
                  <span class="color-orange">Serving Rails from Windows</span> 
                  <span>Dec  2 2012</span>
              </h2>
              <div class="post">
                <p>I was asked to meet quite a &#8220;non-standard&#8221; requirement lately - the client wanted me to serve a Rails application from a Windows server. The application was not very complicated and has only a handful of users so I agreed to give it a shot. While doing this was relatively simple, I decided to blog about it in case it helps anyone.</p>

<p>I decided to go with JRuby as anything that works on JVM theoretically should run on any OS. So I got hold of a clean Windows machine and installed -</p>

<ul>
<li>JDK 1.7</li>

<li>Postgres-9.1</li>

<li>Apache Tomcat 7</li>
</ul>

<p>If you want to run the build on the Windows machine, you would also need -</p>

<ul>
<li>JRuby 1.7</li>

<li>Git 1.8 for Windows</li>
</ul>

<p>Now if your application is a simple Rails application you don&#8217;t have to worry too much, any gem written in Ruby would work well on JRuby. Some gems written in C do not work well on JRuby however JRuby has good alternatives for these too, so just check the gems you are using if they have any C extensions (this is rare so I will not go into details). Since we also want to switch to JDBC drivers for JRuby, I added the following to my Gemfile -</p>

<pre><code>#JRuby specific gems
platform :jruby do
  gem &#39;activerecord-jdbcpostgresql-adapter&#39;, :git =&gt; &#39;https://github.com/jruby/activerecord-jdbc-adapter&#39;
  gem &#39;jruby-openssl&#39;
  gem &#39;jruby-pageant&#39;
  gem &#39;warbler&#39;
end</code></pre>

<p>If you are building the application on Windows, you should have Git and JRuby on the server. Open the git bash terminal and run -</p>

<pre><code>gem install bundler
git clone &lt;your repo here&gt;
bundle install</code></pre>

<p>This should run fine. Note the &#8216;jruby-pageant&#8217; gem we added to the Gemfile, this was one special gem I installed to get the application working on Windows.</p>

<p>Now run -</p>

<pre><code>bundle exec warble config</code></pre>

<p>This will generate a warble.rb file in you application&#8217;s config folder. This file has numerous config options, read it to understand more but usually I just change two values -</p>

<pre><code># Set JRuby to run in 1.9 mode.
config.webxml.jruby.compat.version = &quot;1.9&quot;

# Value of RAILS_ENV for the webapp -- default as shown below
config.webxml.rails.env = ENV[&#39;RAILS_ENV&#39;] || &#39;production&#39;</code></pre>

<p>This is self explanatory stuff. You can also create a custom environment to deploy to Windows if you want.</p>

<p>Now run -</p>

<pre><code>bundle exec rake assets:precompile
bundle exec warble</code></pre>

<p>This will compile your Rails assets and generate a (application-name).war file in your project with all files in the right place. For the non Java folks a .war file is a web archive file that is like a compressed folder that can be copied and deployed to a JEE application server.</p>

<p>Assuming you have created the DB with the database.yml settings for the production environment, now go to your Tomcat installation directory and within that look for the &#8220;webapps&#8221; directory.</p>

<p>To keep our lives simple delete the ROOT folder in this directory and copy the .war we created as ROOT.war here. We do this so that the routes we created in our Rails app do not have to deal with an extra context path if we deploy the app with any other name. ROOT folder in webapps maps to the path &#8220;http://localhost:8080/&#8221; so our application&#8217;s routes remain intact. Please note that if you do not want to build the application on Windows this is the only step you need to do.</p>

<p>Run the apache-tomcat/bin/startup script from your favoured terminal and checkout the logs created in apache-tomcat/logs folder. In case you have missed anything the catalina.out logs will tell you the problem.</p>

<p>You can create a proxy for tomcat using Apache HTTP server if you want. Tomcat specific config like the port on which it is running can be found in apache-tomcat/conf/server.xml.</p>

<p>Also the above steps can be put in a script that can be run from cygwin. That is it, this is all you need to serve a Rails application from Windows. To my surprise I found that the response times were also very good.</p>
              </div>
              <hr/>
              <div id="disqus_thread"></div>
                <script type="text/javascript">
                  $(function(){
                    hljs.initHighlightingOnLoad();
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'rockyj'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  });
                </script>
                <noscript>
                  Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
                </noscript>
                <a href="http://disqus.com" class="dsq-brlink">
                  blog comments powered by <span class="logo-disqus">Disqus</span>
                </a>
            </article>
          </div>
        </div>
        <div class="span3">
  <h2>
    <img src="/images/Rocky_Jaiswal.jpg" alt="Rocky Jaiswal" width="121" height="115" style="max-width: 100%;"/>
    <br/>
    <a href="/about">About</a>
  </h2>
  <hr/>
  <h2>
    <a href="https://github.com/rocky-jaiswal" target="_blank">Github</a> /
    <a href="https://twitter.com/whatsuprocky" target="_blank">Twitter</a>
  </h2>
  <hr/>
  <h2>
    <a href="/videos">Videos</a>
  </h2>
  <hr/>
  <h2>Articles</h2>
  <ol>
    
      <li><a href="/2013/03/22/integrating_node_and_rails_with_redis.html">Integrating Rails and Node.js via Redis</a> <span>Mar 22 2013</span></li>
    
      <li><a href="/2012/12/13/backbone_and_coffeescript.html">Backbone.js and CoffeeScript - A Perfect Match</a> <span>Dec 13 2012</span></li>
    
      <li><a href="/2012/12/02/serving_rails_from_windows.html">Serving Rails from Windows</a> <span>Dec  2 2012</span></li>
    
      <li><a href="/2012/10/15/why_does_js_require_requirejs.html">Why does JavaScript require Require.js</a> <span>Oct 15 2012</span></li>
    
      <li><a href="/2012/09/22/rails_on_only_jvm.html">Rails on only JVM</a> <span>Sep 22 2012</span></li>
    
      <li><a href="/2012/09/15/akka_with_jruby.html">Akka with JRuby</a> <span>Sep 15 2012</span></li>
    
      <li><a href="/2012/09/09/rails_on_ruby_jruby_a_performance_comparison.html">Running Rails on Ruby or JRuby - A Performance Comparison</a> <span>Sep  9 2012</span></li>
    
      <li><a href="/2012/09/01/deploying_java_apps_with_capistrano.html">Deploying Java applications with Capistrano</a> <span>Sep  1 2012</span></li>
    
      <li><a href="/2012/08/26/accessing_server_data_from_a_native_android_app.html">Accessing server data from a native Android app</a> <span>Aug 26 2012</span></li>
    
      <li><a href="/2012/08/18/why_javascript_is_important.html">Why JavaScript is important</a> <span>Aug 18 2012</span></li>
    
      <li><a href="/2012/06/08/non_tangibles_of_agile.html">The non-tangibles of Agile</a> <span>Jun  8 2012</span></li>
    
      <li><a href="/2012/05/28/moved_to_html.html">Blog moved to pure HTML5, CSS3</a> <span>May 28 2012</span></li>
    
      <li><a href="/2012/05/25/intro_to_backbone_jQuery.html">A gentle introduction to Backbone with jQuery</a> <span>May 25 2012</span></li>
    
      <li><a href="/2012/05/21/video_rubyconf_india.html">Video of my talk with @arunagw at RubyConf India 2012</a> <span>May 21 2012</span></li>
    
      <li><a href="/2012/05/08/setting_up_solr.html">Setting up Solr</a> <span>May  8 2012</span></li>
    
      <li><a href="/2012/03/27/old_jboss_video.html">Old JBoss Video</a> <span>Mar 27 2012</span></li>
    
      <li><a href="/2012/03/26/ruby_conf_india_with_arunagw.html">Slides of my talk with @arunagw in Ruby Conf India 2012</a> <span>Mar 26 2012</span></li>
    
      <li><a href="/2012/03/23/embracing_jruby_1.html">Embracing JRuby - Part 1</a> <span>Mar 23 2012</span></li>
    
      <li><a href="/2012/03/05/musings_on_india_and_technology.html">Musings on India and Technology</a> <span>Mar  5 2012</span></li>
    
      <li><a href="/2012/01/31/job_of_a_software_developer.html">The Job of a Software Developer</a> <span>Jan 31 2012</span></li>
    
      <li><a href="/2011/12/27/a-weekend-with-couchdb-solr-and-torquebox.html">A weekend with CouchDB, Solr and Torquebox</a> <span>Dec 27 2011</span></li>
    
      <li><a href="/2011/12/27/configuring-nginx-with-jboss-tomcat.html">Configuring nginx with JBoss / Tomcat</a> <span>Dec 27 2011</span></li>
    
      <li><a href="/2011/12/01/jquery-flavored-coffeescript.html">jQuery flavored CoffeeScript</a> <span>Dec  1 2011</span></li>
    
      <li><a href="/2011/07/26/and-then-there-was-closure.html">And then there was Closure</a> <span>Jul 26 2011</span></li>
    
      <li><a href="/2011/07/04/the-problem-is-choice.html">The problem is choice</a> <span>Jul  4 2011</span></li>
    
      <li><a href="/2011/06/29/using-spring-for-scheduling-tasks.html">Using Spring for Scheduling Tasks</a> <span>Jun 29 2011</span></li>
    
      <li><a href="/2011/06/25/working-with-oracle-on-linux-ubuntu-fedora.html">Installing Oracle on Linux (Ubuntu / Fedora)</a> <span>Jun 25 2011</span></li>
    
      <li><a href="/2011/06/25/excel-manipulation-and-testing-in-java.html">Excel manipulation and testing in Java</a> <span>Jun 25 2011</span></li>
    
      <li><a href="/2011/06/06/putting-couchdb-and-rails-on-the-cloud.html">Putting CouchDB and Rails on the Cloud</a> <span>Jun  6 2011</span></li>
    
      <li><a href="/2011/05/16/integrating-google-re-captcha-with-a-rails-app.html">Integrating Google Re-Captcha with a Rails app</a> <span>May 16 2011</span></li>
    
      <li><a href="/2011/05/03/the-real-purpose-of-a-sprint-goal.html">The real purpose of a Sprint Goal</a> <span>May  3 2011</span></li>
    
      <li><a href="/2011/05/02/thoughts-of-the-week-24-30-april.html">Thoughts of the week 24 - 30 April</a> <span>May  2 2011</span></li>
    
      <li><a href="/2011/05/02/views-from-across-the-table.html">Views from across the table</a> <span>May  2 2011</span></li>
    
      <li><a href="/2011/04/20/be-happy-to-fail.html">Be Happy to Fail</a> <span>Apr 20 2011</span></li>
    
      <li><a href="/2011/04/14/using-rvm-on-ubuntu-to-install-multiple-versions-of-ruby.html">Using RVM on Ubuntu to install (multiple versions of) Ruby</a> <span>Apr 14 2011</span></li>
    
      <li><a href="/2011/04/11/thoughts-of-the-week-4-10-april.html">Thoughts of the week (4 - 10 April)</a> <span>Apr 11 2011</span></li>
    
      <li><a href="/2011/04/08/mapreduce-in-english.html">MapReduce in English</a> <span>Apr  8 2011</span></li>
    
      <li><a href="/2011/04/01/java-and-ruby-integration-via-soap.html">Java and Ruby integration via SOAP</a> <span>Apr  1 2011</span></li>
    
      <li><a href="/2011/04/01/hello-world.html">Integrating JRuby and Java to create a mini rules engine</a> <span>Apr  1 2011</span></li>
    
      <li><a href="/2011/03/31/google-app-engine-maven-jsf2.html">Google App Engine + Maven + JSF2</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/hello-jquery.html">Hello jQuery!</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/integrating-spring-3-with-jpa-2.html">Integrating Spring 3 with JPA 2</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/accessing-jboss-managed-resources-using-mbeans.html">Accessing JBoss managed resources using MBeans</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/from-zero-to-a-crud-app-without-writing-a-single-line-of-code-using-jruby.html">From Zero to a CRUD App (without writing a single line of code) using JRuby</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/11/big-bad-projects.html">Big bad projects</a> <span>Mar 11 2011</span></li>
    
      <li><a href="/2011/03/01/working-with-git.html">Working with Git</a> <span>Mar  1 2011</span></li>
    
  </ol>
  <hr/>
  <h2>Tags</h2>
  <ol>
    
      <li><a href="/tags/couchdb.html">CouchDB (2)</a></li>
    
      <li><a href="/tags/nosql.html">NoSQL (1)</a></li>
    
      <li><a href="/tags/torquebox.html">Torquebox (4)</a></li>
    
      <li><a href="/tags/solr.html">Solr (2)</a></li>
    
      <li><a href="/tags/agile.html">Agile (7)</a></li>
    
      <li><a href="/tags/general.html">General (6)</a></li>
    
      <li><a href="/tags/jruby.html">JRuby (11)</a></li>
    
      <li><a href="/tags/cloud.html">Cloud (1)</a></li>
    
      <li><a href="/tags/java.html">Java (9)</a></li>
    
      <li><a href="/tags/maven.html">Maven (1)</a></li>
    
      <li><a href="/tags/rails.html">Rails (6)</a></li>
    
      <li><a href="/tags/ruby.html">Ruby (8)</a></li>
    
      <li><a href="/tags/jquery.html">jQuery (1)</a></li>
    
      <li><a href="/tags/javascript.html">JavaScript (7)</a></li>
    
      <li><a href="/tags/coffeescript.html">CoffeeScript (4)</a></li>
    
      <li><a href="/tags/linux.html">Linux (1)</a></li>
    
      <li><a href="/tags/capistrano.html">Capistrano (1)</a></li>
    
      <li><a href="/tags/android.html">Android (1)</a></li>
    
      <li><a href="/tags/phonegap.html">Phonegap (1)</a></li>
    
      <li><a href="/tags/backbone.html">Backbone (3)</a></li>
    
      <li><a href="/tags/spring.html">Spring (2)</a></li>
    
      <li><a href="/tags/jboss.html">Jboss (1)</a></li>
    
      <li><a href="/tags/tomcat.html">Tomcat (1)</a></li>
    
      <li><a href="/tags/jpa.html">JPA (1)</a></li>
    
      <li><a href="/tags/programming.html">Programming (1)</a></li>
    
      <li><a href="/tags/jboss.html">JBoss (2)</a></li>
    
      <li><a href="/tags/git.html">Git (1)</a></li>
    
      <li><a href="/tags/node-js.html">Node.js (1)</a></li>
    
      <li><a href="/tags/require-js.html">Require.js (1)</a></li>
    
      <li><a href="/tags/scala.html">Scala (1)</a></li>
    
      <li><a href="/tags/akka.html">Akka (1)</a></li>
    
  </ol>
  <hr/>
</div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-10309067-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
      </div>
    </div>
  </body>
</html>
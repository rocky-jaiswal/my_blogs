<!DOCTYPE html>
<html>
  <head>
  <title>Rocky Jaiswal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap-responsive.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/github.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/jquery.js" type="text/javascript"></script>
  <script src="/javascripts/bootstrap.js" type="text/javascript"></script>
  <script src="/javascripts/highlight.pack.js" type="text/javascript"></script>
</head>
  <body>
    <div class="banner">
  <div class="container">
    <h1>
      <a class="head" href="/"><img src="/images/rockyj_banner.png"/></a>
    </h1>
  </div>
</div>
    <div id="main" role="main" class="container">
      <div class="row">
        <div class="span9">
          <div id="main" role="main">
            <article>
              <h2>
                  <span class="color-orange">Java and Ruby integration via SOAP</span> 
                  <span>Apr  1 2011</span>
              </h2>
              <div class="post">
                <p>In my last blog we talked about Ruby and Java integration via JRuby. Since JRuby runs on JVM, bytecode can be shared but in case you do not want a JVM level integration then SOAP is usually your next level of support.</p>

<p>Imagine a scenario where you want to call a SOAP server written in Java from Ruby, this is quite common as most enterprises have their middleware written in Java and new application can be written quickly in Ruby/Rails. Here is how you can go about integrating the two -</p>

<p><strong>The Java Server</strong></p>

<p>I am not going to cover this in detail here but for new deployments Apache CXF is quite popular. You can integrate it with Spring as given <a href='https://cwiki.apache.org/CXF20DOC/writing-a-service-with-spring.html'>here</a>. The Maven dependencies are as follows -</p>
<properties>
    <cxf.version>2.3.3</cxf.version>
    <spring.version>3.0.4.RELEASE</spring.version>
  </properties><dependencies>
  	<!-- CXF dependencies -->
  	<dependency>
  		<groupId>org.apache.cxf</groupId>
  		<artifactId>cxf-rt-frontend-jaxws</artifactId>
  		<version>${cxf.version}</version>
  	</dependency>
  	<dependency>
  		<groupId>org.apache.cxf</groupId>
  		<artifactId>cxf-rt-transports-http</artifactId>
  		<version>${cxf.version}</version>
  	</dependency>
        <!-- End CXF dependencies -->

        <!-- Spring dependencies -->
        <!-- add other dependencies -->
  </dependencies>
<p>The Java code looks like -</p>

<p>@WebService public interface EmployeeService {</p>

<pre><code>Employee findEmployeeByID(@WebParam(name = &quot;employeeID&quot;)long empID);
boolean storeEmployee(@WebParam(name = &quot;employee&quot;)Employee emp);</code></pre>

<p>}</p>

<p>And the Implementation looks like -</p>

<p>@Component(&#8220;employeeService&#8221;) @WebService(endpointInterface = &#8220;in.mysoapserver.services.EmployeeService&#8221;) public class EmployeeServiceImpl implements EmployeeService {</p>

<pre><code>@Override
public Employee findEmployeeByID(long empID) {
	Employee employee = new Employee();
	employee.setEmpID(101);
	employee.setName(&quot;Rocky&quot;);
	employee.setAge(32);
	return employee;
}

@Override
public boolean storeEmployee(Employee emp) {
	//Store Employee
	return true;
}</code></pre>

<p>}</p>

<p>After deploying the project in Tomcat you can get the WSDL from a link like - <strong>http://localhost:8080/mysoapserver/soap?wsdl</strong></p>

<p>Once you have the WSDL you should use SoapUI for some testing to check if the SOAP requests are working.</p>

<p><strong>The Ruby Client</strong> Now we are ready to create the SOAP client in Ruby. Please note the instructions below are same for Ruby or JRuby.</p>

<p>First install soap4r gem - <strong>gem install soap4r</strong></p>

<p>Download (and unpack) the soap4r binary .tar.gz also from <a href='http://dev.ctor.org/soap4r'>here</a></p>

<p>Now, just to organize things create a folder say &#8220;ruby_soap_client&#8221; and copy the WSDL of the SOAP services we created there.</p>

<p>Got to the folder where the WSDL is copied and run - <strong>~/01rocky/02apps/soap4r-1.5.8/bin/wsdl2ruby.rb &#8211;type client &#8211;wsdl mysoapserver.wsdl</strong></p>

<ul>
<li>Change the path to wsdl2ruby.rb as per your setup.</li>
</ul>

<p>This will create a set of Ruby scripts and also create an example client. Since we will make our own client you can safely delete the <em>Client.rb and</em>Driver.rb scripts.</p>

<p>Now let us create our own Ruby client -</p>

<p>require &#8216;soap/wsdlDriver&#8217; require &#8216;EmployeeServiceImplService.rb&#8217;</p>

<p>wsdl = &#8220;mysoapserver.wsdl&#8221;</p>

<p>employee_service = SOAP::WSDLDriverFactory.new(wsdl).create_rpc_driver</p>

<p>response = employee_service.findEmployeeByID(FindEmployeeByID.new(10)) puts response.return.name puts response.return.age</p>

<p>response = employee_service.storeEmployee(StoreEmployee.new(Employee.new(30,102,&#8221;Tushar&#8221;))) puts response.return</p>

<p>Lets examine each line in detail. Line 1 - Just loading the required libraries for soap4r Line 2 - The 3rd file that wsdl2ruby.rb script generated. We&#8217;ll look at it in a minute. Line 4 - Just a variable for the wsdl file name. Change it according to your setup. Line 6 - We create a SOAP RPC driver using the wsdl we saved earlier. Line 8/12 - Next we make the SOAP call. But wait a minute, what is being passed as a parameter here?</p>

<p>The answer to this can be found if we look at the SOAP request we made from SoapUI -</p>
<soapenv:Envelope xmlns:ser='http://services.mysoapserver.in/' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/'>
     <soapenv:Header />
     <soapenv:Body>
        <ser:findEmployeeByID>
           <employeeID>10</employeeID>
        </ser:findEmployeeByID>
     </soapenv:Body>
  </soapenv:Envelope>
<p>And for storeEmployee call -</p>
<soapenv:Envelope xmlns:ser='http://services.mysoapserver.in/' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/'>
     <soapenv:Header />
     <soapenv:Body>
        <ser:storeEmployee>
           <employee>
              <age>30</age>
              <empID>102</empID>
              <name>Tushar</name>
           </employee>
        </ser:storeEmployee>
     </soapenv:Body>
  </soapenv:Envelope>
<p>If we ignore the XML namespaces, our request is wrapped in a &#8220;findEmployeeByID&#8221; tag (for the findEmployeeByID call). Therefore, when we gave the wsdl2ruby.rb scpirt our WSDL reference, it created the equivalent Ruby classes for all wrappers, request and response types and stored it in a file which we referenced at Line 2.</p>

<p>So looking at the sample requests in SoapUI we can create wrapper and request objects and similarly parse the response received. Its as simple as that. In case you are stuck, you can look at all the classes created by the wsdl2ruby script by having a look at the generated file (EmployeeServiceImplService.rb in our case).</p>
              </div>
              <hr/>
              <div id="disqus_thread"></div>
                <script type="text/javascript">
                  $(function(){
                    hljs.initHighlightingOnLoad();
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'rockyj'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                  });
                </script>
                <noscript>
                  Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
                </noscript>
                <a href="http://disqus.com" class="dsq-brlink">
                  blog comments powered by <span class="logo-disqus">Disqus</span>
                </a>
            </article>
          </div>
        </div>
        <div class="span3">
  <h2>
    <img src="/images/Rocky_Jaiswal.jpg" alt="Rocky Jaiswal" width="121" height="115" style="max-width: 100%;"/>
    <br/>
    <a href="/about">About</a>
  </h2>
  <hr/>
  <h2>
    <a href="http://github.com/rocky-jaiswal" target="_blank">Github</a>
  </h2>
  <hr/>
  <h2>Articles</h2>
  <ol>
    
      <li><a href="/2012/09/15/akka_with_jruby.html">Akka with JRuby</a> <span>Sep 15 2012</span></li>
    
      <li><a href="/2012/09/09/rails_on_ruby_jruby_a_performance_comparison.html">Running Rails on Ruby or JRuby - A Performance Comparison</a> <span>Sep  9 2012</span></li>
    
      <li><a href="/2012/09/01/deploying_java_apps_with_capistrano.html">Deploying Java applications with Capistrano</a> <span>Sep  1 2012</span></li>
    
      <li><a href="/2012/08/26/accessing_server_data_from_a_native_android_app.html">Accessing server data from a native Android app</a> <span>Aug 26 2012</span></li>
    
      <li><a href="/2012/08/18/why_javascript_is_important.html">Why JavaScript is important</a> <span>Aug 18 2012</span></li>
    
      <li><a href="/2012/06/08/non_tangibles_of_agile.html">The non-tangibles of Agile</a> <span>Jun  8 2012</span></li>
    
      <li><a href="/2012/05/28/moved_to_html.html">Blog moved to pure HTML5, CSS3</a> <span>May 28 2012</span></li>
    
      <li><a href="/2012/05/25/intro_to_backbone_jQuery.html">A gentle introduction to Backbone with jQuery</a> <span>May 25 2012</span></li>
    
      <li><a href="/2012/05/21/video_rubyconf_india.html">Video of my talk with @arunagw at RubyConf India 2012</a> <span>May 21 2012</span></li>
    
      <li><a href="/2012/05/08/setting_up_solr.html">Setting up Solr</a> <span>May  8 2012</span></li>
    
      <li><a href="/2012/03/27/old_jboss_video.html">Old JBoss Video</a> <span>Mar 27 2012</span></li>
    
      <li><a href="/2012/03/26/ruby_conf_india_with_arunagw.html">Slides of my talk with @arunagw in Ruby Conf India 2012</a> <span>Mar 26 2012</span></li>
    
      <li><a href="/2012/03/23/embracing_jruby_1.html">Embracing JRuby - Part 1</a> <span>Mar 23 2012</span></li>
    
      <li><a href="/2012/03/05/musings_on_india_and_technology.html">Musings on India and Technology</a> <span>Mar  5 2012</span></li>
    
      <li><a href="/2012/01/31/job_of_a_software_developer.html">The Job of a Software Developer</a> <span>Jan 31 2012</span></li>
    
      <li><a href="/2011/12/27/configuring-nginx-with-jboss-tomcat.html">Configuring nginx with JBoss / Tomcat</a> <span>Dec 27 2011</span></li>
    
      <li><a href="/2011/12/27/a-weekend-with-couchdb-solr-and-torquebox.html">A weekend with CouchDB, Solr and Torquebox</a> <span>Dec 27 2011</span></li>
    
      <li><a href="/2011/12/01/jquery-flavored-coffeescript.html">jQuery flavored CoffeeScript</a> <span>Dec  1 2011</span></li>
    
      <li><a href="/2011/07/26/and-then-there-was-closure.html">And then there was Closure</a> <span>Jul 26 2011</span></li>
    
      <li><a href="/2011/07/04/the-problem-is-choice.html">The problem is choice</a> <span>Jul  4 2011</span></li>
    
      <li><a href="/2011/06/29/using-spring-for-scheduling-tasks.html">Using Spring for Scheduling Tasks</a> <span>Jun 29 2011</span></li>
    
      <li><a href="/2011/06/25/working-with-oracle-on-linux-ubuntu-fedora.html">Installing Oracle on Linux (Ubuntu / Fedora)</a> <span>Jun 25 2011</span></li>
    
      <li><a href="/2011/06/25/excel-manipulation-and-testing-in-java.html">Excel manipulation and testing in Java</a> <span>Jun 25 2011</span></li>
    
      <li><a href="/2011/06/06/putting-couchdb-and-rails-on-the-cloud.html">Putting CouchDB and Rails on the Cloud</a> <span>Jun  6 2011</span></li>
    
      <li><a href="/2011/05/16/integrating-google-re-captcha-with-a-rails-app.html">Integrating Google Re-Captcha with a Rails app</a> <span>May 16 2011</span></li>
    
      <li><a href="/2011/05/03/the-real-purpose-of-a-sprint-goal.html">The real purpose of a Sprint Goal</a> <span>May  3 2011</span></li>
    
      <li><a href="/2011/05/02/views-from-across-the-table.html">Views from across the table</a> <span>May  2 2011</span></li>
    
      <li><a href="/2011/05/02/thoughts-of-the-week-24-30-april.html">Thoughts of the week 24 - 30 April</a> <span>May  2 2011</span></li>
    
      <li><a href="/2011/04/20/be-happy-to-fail.html">Be Happy to Fail</a> <span>Apr 20 2011</span></li>
    
      <li><a href="/2011/04/14/using-rvm-on-ubuntu-to-install-multiple-versions-of-ruby.html">Using RVM on Ubuntu to install (multiple versions of) Ruby</a> <span>Apr 14 2011</span></li>
    
      <li><a href="/2011/04/11/thoughts-of-the-week-4-10-april.html">Thoughts of the week (4 - 10 April)</a> <span>Apr 11 2011</span></li>
    
      <li><a href="/2011/04/08/mapreduce-in-english.html">MapReduce in English</a> <span>Apr  8 2011</span></li>
    
      <li><a href="/2011/04/01/java-and-ruby-integration-via-soap.html">Java and Ruby integration via SOAP</a> <span>Apr  1 2011</span></li>
    
      <li><a href="/2011/04/01/hello-world.html">Integrating JRuby and Java to create a mini rules engine</a> <span>Apr  1 2011</span></li>
    
      <li><a href="/2011/03/31/accessing-jboss-managed-resources-using-mbeans.html">Accessing JBoss managed resources using MBeans</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/from-zero-to-a-crud-app-without-writing-a-single-line-of-code-using-jruby.html">From Zero to a CRUD App (without writing a single line of code) using JRuby</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/google-app-engine-maven-jsf2.html">Google App Engine + Maven + JSF2</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/hello-jquery.html">Hello jQuery!</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/31/integrating-spring-3-with-jpa-2.html">Integrating Spring 3 with JPA 2</a> <span>Mar 31 2011</span></li>
    
      <li><a href="/2011/03/11/big-bad-projects.html">Big bad projects</a> <span>Mar 11 2011</span></li>
    
      <li><a href="/2011/03/01/working-with-git.html">Working with Git</a> <span>Mar  1 2011</span></li>
    
  </ol>
  <hr/>
  <h2>Tags</h2>
  <ol>
    
      <li><a href="tags/jboss.html">JBoss (2)</a></li>
    
      <li><a href="tags/agile.html">Agile (7)</a></li>
    
      <li><a href="tags/general.html">General (6)</a></li>
    
      <li><a href="tags/java.html">Java (9)</a></li>
    
      <li><a href="tags/jruby.html">JRuby (9)</a></li>
    
      <li><a href="tags/ruby.html">Ruby (7)</a></li>
    
      <li><a href="tags/capistrano.html">Capistrano (1)</a></li>
    
      <li><a href="tags/git.html">Git (1)</a></li>
    
      <li><a href="tags/javascript.html">JavaScript (4)</a></li>
    
      <li><a href="tags/solr.html">Solr (2)</a></li>
    
      <li><a href="tags/jpa.html">JPA (1)</a></li>
    
      <li><a href="tags/spring.html">Spring (2)</a></li>
    
      <li><a href="tags/coffeescript.html">CoffeeScript (1)</a></li>
    
      <li><a href="tags/rails.html">Rails (3)</a></li>
    
      <li><a href="tags/torquebox.html">Torquebox (3)</a></li>
    
      <li><a href="tags/couchdb.html">CouchDB (2)</a></li>
    
      <li><a href="tags/nosql.html">NoSQL (1)</a></li>
    
      <li><a href="tags/jquery.html">jQuery (1)</a></li>
    
      <li><a href="tags/backbone.html">Backbone (2)</a></li>
    
      <li><a href="tags/linux.html">Linux (1)</a></li>
    
      <li><a href="tags/programming.html">Programming (1)</a></li>
    
      <li><a href="tags/android.html">Android (1)</a></li>
    
      <li><a href="tags/phonegap.html">Phonegap (1)</a></li>
    
      <li><a href="tags/scala.html">Scala (1)</a></li>
    
      <li><a href="tags/akka.html">Akka (1)</a></li>
    
      <li><a href="tags/jboss.html">Jboss (1)</a></li>
    
      <li><a href="tags/tomcat.html">Tomcat (1)</a></li>
    
      <li><a href="tags/cloud.html">Cloud (1)</a></li>
    
      <li><a href="tags/maven.html">Maven (1)</a></li>
    
  </ol>
  <hr/>
</div>
      </div>
    </div>
  </body>
</html>